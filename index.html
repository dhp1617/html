<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Giant AR Object Visible From Far</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-gps-entity-place.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; }
    #status {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px;
      z-index: 10000;
      font-family: Arial;
    }
  </style>
</head>
<body>
  <div id="status">Initializing AR experience...</div>
  
  <a-scene 
    vr-mode-ui="enabled: false" 
    embedded 
    arjs="sourceType: webcam; debugUIEnabled: false;"
    renderer="logarithmicDepthBuffer: true;"
  >
    <!-- Camera setup -->
    <a-entity camera></a-entity>

    <!-- GIANT VISIBLE OBJECT -->
    <a-entity
      id="giant-object"
      gps-entity-place="latitude: 10.939230; longitude: 76.743130"
    >
      <!-- Massive pyramid (500m base, 300m height) -->
      <a-cone 
        color="#FF0000" 
        radius-bottom="250" 
        radius-top="10" 
        height="300"
        position="0 150 0"
        material="transparent: true; opacity: 0.7;"
      ></a-cone>
      
      <!-- Glowing sphere at top -->
      <a-sphere
        color="yellow"
        radius="50"
        position="0 300 0"
        material="shader: flat;"
        light="type: point; intensity: 1; color: yellow"
      ></a-sphere>
      
      <!-- Floating label -->
      <a-text 
        value="TOUR POINT" 
        color="#FFFFFF" 
        position="0 400 0" 
        scale="150 150 150"
        align="center"
      ></a-text>
    </a-entity>
  </a-scene>

  <script>
    const statusElement = document.getElementById('status');
    const giantObject = document.getElementById('giant-object');
    let userPosition = null;

    // Check if required libraries loaded
    if (!window.ARjs || !window.AFRAME) {
      statusElement.innerHTML = "Error: AR libraries failed to load. Refresh page.";
    }

    // Configure AR scene events
    const scene = document.querySelector('a-scene');
    scene.addEventListener('arjs-ftor-ready', () => {
      statusElement.innerHTML += "<br>AR camera ready!";
    });

    // Continuous GPS tracking
    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(
        (position) => {
          userPosition = position;
          const userLat = position.coords.latitude;
          const userLng = position.coords.longitude;
          const targetLat = 10.939230;
          const targetLng = 76.743130;
          
          const distance = calculateDistance(userLat, userLng, targetLat, targetLng);
          statusElement.innerHTML = `
            <strong>Giant AR Object</strong><br>
            Your position: ${userLat.toFixed(6)}, ${userLng.toFixed(6)}<br>
            Distance to target: ${(distance/1000).toFixed(2)} km<br>
            GPS accuracy: ±${position.coords.accuracy.toFixed(1)} meters<br>
            <small>Look around - object should be visible from several kilometers away</small>
          `;
          
          // Scale object based on distance (makes it even more visible)
          const scaleFactor = Math.min(1, 10000/distance);
          giantObject.setAttribute('scale', `${scaleFactor} ${scaleFactor} ${scaleFactor}`);
        },
        (error) => {
          statusElement.innerHTML = `GPS Error: ${error.message}`;
        },
        {
          enableHighAccuracy: true,
          maximumAge: 5000,
          timeout: 10000
        }
      );
    } else {
      statusElement.innerHTML = "Error: Geolocation not supported by your device";
    }

    // Distance calculation (Haversine formula)
    function calculateDistance(lat1, lon1, lat2, lon2) {
      const R = 6371000; // Earth radius in meters
      const φ1 = lat1 * Math.PI / 180;
      const φ2 = lat2 * Math.PI / 180;
      const Δφ = (lat2 - lat1) * Math.PI / 180;
      const Δλ = (lon2 - lon1) * Math.PI / 180;

      const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +
                Math.cos(φ1) * Math.cos(φ2) *
                Math.sin(Δλ / 2) * Math.sin(Δλ / 2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

      return R * c;
    }
  </script>
</body>
</html>
